<div class="lab-page-wrapper">
    <div class="lab-page {{labView}}">
        <div class="steps-bar-wrapper">
            <ul class="steps-bar">
                <li *ngFor="let step of steps" class="steps-bar-item" [ngClass]="step.id == currentStep ? 'active' : step.id < currentStep ? 'completed': ''">
                    <div class="step-item-num">{{step.id}}</div><div>{{step.name}}</div></li>
            </ul>
        </div>


        <!--    PAGE TITLES-->
        <div class="row lab-row page-title-row figure-title-row">
            <!-- PAGE MAIN TITLE -->
            <div class="col text-center">
                <div *ngIf="!labItem" class=""><span
                        class="underline-warning">{{'LAB.title' | translate}}</span>
                </div>
            </div>
            <!-- PAGE SUB TITLE - AFTER STARR VIDEO UPLOADED -->
            <div *ngIf="labItem" class="col-12 pb-2 text-center">
            <span dsappStarName
                  [name]="labItem.star.name">
            </span>
                <span> - </span>
                <span>{{labItem.figure.name}},
                    {{'STAR.STAR_INFO_PAGE.level' | translate}}
                    {{labItem.figure.level}}</span>
            </div>
        </div>

        <ng-container [ngSwitch]="labView">
            <ng-container *ngSwitchCase="'full'"
                          [ngTemplateOutlet]="labTool">
            </ng-container>

            <ng-container *ngSwitchCase="'preview'">
                <ng-container [ngTemplateOutlet]="labTool"></ng-container>
                <ng-container [ngTemplateOutlet]="emptyUserVideo"></ng-container>
            </ng-container>

            <ng-container *ngSwitchCase="'empty'">
                <ng-container [ngTemplateOutlet]="emptyStarVideo"></ng-container>
                <!--            <ng-container [ngTemplateOutlet]="emptyUserVideo"></ng-container>-->
            </ng-container>
        </ng-container>



    </div>

    <!-- STAR VIDEO IS NOT SELECTED --->
    <ng-template #emptyStarVideo>
        <div class="row lab-row choose-star-video-row text-center">
            <div class="col">
                <div class="toolbox">
                    <div class="lab-choose-video-text">{{'LAB.instruction' | translate}}</div>
                    <div class="text-center">
                        <button class="btn lab-button start-button"
                                tabindex="0"
                                [routerLink]="['/student','star']">
                            <!--                        <span class="icon-video-2"></span>-->
                            {{'LAB.chooseVideo' | translate}}
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </ng-template>
    <!-- USER MUST TO UPLOAD --->
    <ng-template #emptyUserVideo>
        <div class="row lab-row choose-user-video-row text-center">
            <div class="col">
                <div class="toolbox">
                    <ui-video-file-picker
                            [disableButtons]="disableUserVideoButtons"
                            (videoChange)="userVideoFileChanged($event)">
                    </ui-video-file-picker>
                </div>
            </div>
        </div>
    </ng-template>
    <!--</div>-->

    <!-- FULL LAB TOOL --->
    <ng-template #labTool>
        <div class="row star-video-row">
            <div class="col">
                <dsapp-lab-video-tool [masterVideo]="labItem.starVideo ? labItem.starVideo : null"
                                      [studentVideo]="labItem.userVideo ? labItem.userVideo : null"
                                      (masterPlayerDurationReady)="setDurationLimit($event)"
                                      (isPlayerReady)="masterVideoReady()"
                                      (clearVideo)="clearVideo($event)">
                </dsapp-lab-video-tool>
            </div>
        </div>
    </ng-template>
    <div *ngIf="labView=='full'"
         class="mt-4 mb-4 d-flex justify-content-center">
        <button class="btn btn-danger text-center"
                [disabled]="practiceIsSaved || disableSavePracticesButton"
                (click)="saveToPractices()">
            <i class="icon icon-practices pr-2"></i>{{'LAB.saveToMyPractices' | translate}}</button>
    </div>
    <video #videoMta
           style="display: none;"
           *ngIf="userVideo"
           width="0"
           height="0"
           preload="metadata"
           controls="false"
           playsinline
           webkit-playsinline
           [attr.src]="userVideo.path"
           (loadedmetadata)="checkUserVideoDuration($event)">
    </video>
</div>
